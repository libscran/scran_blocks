<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_core_utils: scran::block_weights Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_core_utils
   </div>
   <div id="projectbrief">Core utilities for libscran</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1block__weights.html">block_weights</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::block_weights Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Calculation of per-block weights.  
<a href="namespacescran_1_1block__weights.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1block__weights_1_1VariableParameters.html">VariableParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters for <code><a class="el" href="namespacescran_1_1block__weights.html#a87cc462ecac05cd391007c5b1dd77cfc">compute_variable()</a></code>.  <a href="structscran_1_1block__weights_1_1VariableParameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa73ad0ce9a2905611bb940a210323bf7" id="r_aa73ad0ce9a2905611bb940a210323bf7"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran_1_1block__weights.html#aa73ad0ce9a2905611bb940a210323bf7">Policy</a> : char { <b>NONE</b>
, <b>VARIABLE</b>
, <b>EQUAL</b>
 }</td></tr>
<tr class="separator:aa73ad0ce9a2905611bb940a210323bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a87cc462ecac05cd391007c5b1dd77cfc" id="r_a87cc462ecac05cd391007c5b1dd77cfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran_1_1block__weights.html#a87cc462ecac05cd391007c5b1dd77cfc">compute_variable</a> (<a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">double</a> <a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">s</a>, <a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">const</a> <a class="el" href="structscran_1_1block__weights_1_1VariableParameters.html">VariableParameters</a> &amp;<a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">params</a>)</td></tr>
<tr class="separator:a87cc462ecac05cd391007c5b1dd77cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9e797af79dad83d063605d50b7099e" id="r_a1a9e797af79dad83d063605d50b7099e"><td class="memTemplParams" colspan="2">template&lt;typename Size_ &gt; </td></tr>
<tr class="memitem:a1a9e797af79dad83d063605d50b7099e"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">compute</a> (const std::vector&lt; Size_ &gt; &amp;sizes, <a class="el" href="namespacescran_1_1block__weights.html#aa73ad0ce9a2905611bb940a210323bf7">Policy</a> policy, const <a class="el" href="structscran_1_1block__weights_1_1VariableParameters.html">VariableParameters</a> &amp;variable)</td></tr>
<tr class="separator:a1a9e797af79dad83d063605d50b7099e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculation of per-block weights. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aa73ad0ce9a2905611bb940a210323bf7" name="aa73ad0ce9a2905611bb940a210323bf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73ad0ce9a2905611bb940a210323bf7">&#9670;&#160;</a></span>Policy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">enum</a> <a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">class</a> <a class="el" href="namespacescran_1_1block__weights.html#aa73ad0ce9a2905611bb940a210323bf7">scran::block_weights::Policy</a> : <a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">char</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Policy to use for weighting blocks based on their size, i.e., the number of cells in each block. This controls the calculation of weighted averages across blocks.</p>
<ul>
<li><code>NONE</code>: no weighting is performed. Larger blocks will contribute more to the weighted average.</li>
<li><code>EQUAL</code>: each block receives equal weight, regardless of its size. Equivalent to averaging across blocks without weights.</li>
<li><code>VARIABLE</code>: each batch is weighted using the logic in <code><a class="el" href="namespacescran_1_1block__weights.html#a87cc462ecac05cd391007c5b1dd77cfc">compute_variable()</a></code>. This penalizes small blocks with unreliable statistics while equally weighting all large blocks. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1a9e797af79dad83d063605d50b7099e" name="a1a9e797af79dad83d063605d50b7099e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a9e797af79dad83d063605d50b7099e">&#9670;&#160;</a></span>compute()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Size_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; scran::block_weights::compute </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Size_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran_1_1block__weights.html#aa73ad0ce9a2905611bb940a210323bf7">Policy</a>&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1block__weights_1_1VariableParameters.html">VariableParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute block weights for multiple blocks based on their size and the weighting policy. For variable weights, this function will call <code><a class="el" href="namespacescran_1_1block__weights.html#a87cc462ecac05cd391007c5b1dd77cfc">compute_variable()</a></code> for each block.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Size_</td><td>Numeric type for the block size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sizes</td><td>Vector of block sizes. </td></tr>
    <tr><td class="paramname">policy</td><td>Policy for weighting blocks of different sizes. </td></tr>
    <tr><td class="paramname">variable</td><td>Parameters for the variable block weights.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of block weights. </dd></dl>

</div>
</div>
<a id="a87cc462ecac05cd391007c5b1dd77cfc" name="a87cc462ecac05cd391007c5b1dd77cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87cc462ecac05cd391007c5b1dd77cfc">&#9670;&#160;</a></span>compute_variable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">double</a> scran::block_weights::compute_variable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">double</a>&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran_1_1block__weights.html#a1a9e797af79dad83d063605d50b7099e">const</a> <a class="el" href="structscran_1_1block__weights_1_1VariableParameters.html">VariableParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weight each block of cells for use in computing a weighted average across blocks. The weight for each block is calcualted from the size of that block.</p>
<ul>
<li>If the block is smaller than some lower bound, it has zero weight.</li>
<li>If the block is greater than some upper bound, it has weight of 1.</li>
<li>Otherwise, the block has weight proportional to its size, increasing linearly from 0 to 1 between the two bounds.</li>
</ul>
<p>Blocks that are "large enough" are considered to be equally trustworthy and receive the same weight, ensuring that each block contributes equally to the weighted average. By comparison, very small blocks receive lower weight as their statistics are generally less stable. If both <code>cap</code> and <code>block_size</code> are zero, the weight is also set to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Size of the block, in terms of the number of cells in that block. </td></tr>
    <tr><td class="paramname">params</td><td>Parameters for the weight calculation, consisting of the lower and upper bounds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Weight of the block, to use for computing a weighted average across blocks. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
