<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_blocks: scran_blocks Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_blocks
   </div>
   <div id="projectbrief">Blocking utilities for libscran</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran_blocks Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Blocking utilities for <b>libscran</b>.  
<a href="namespacescran__blocks.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters for <code><a class="el" href="namespacescran__blocks.html#a0748c931e9c1250186a7794dcd440238">compute_variable_weight()</a></code>.  <a href="structscran__blocks_1_1VariableWeightParameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac2412948da94055ff438267ba089ba97" id="r_ac2412948da94055ff438267ba089ba97"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">WeightPolicy</a> : char { <b>NONE</b>
, <b>VARIABLE</b>
, <b>EQUAL</b>
 }</td></tr>
<tr class="separator:ac2412948da94055ff438267ba089ba97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6fcb43b96a8b97c00cfaf3ae83df028d" id="r_a6fcb43b96a8b97c00cfaf3ae83df028d"><td class="memTemplParams" colspan="2">template&lt;typename Stat_ , typename Output_ &gt; </td></tr>
<tr class="memitem:a6fcb43b96a8b97c00cfaf3ae83df028d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">average_vectors</a> (size_t n, std::vector&lt; Stat_ * &gt; in, Output_ *out, bool skip_nan)</td></tr>
<tr class="separator:a6fcb43b96a8b97c00cfaf3ae83df028d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4fcc523c305a36b9d4b7f031367d13" id="r_ace4fcc523c305a36b9d4b7f031367d13"><td class="memTemplParams" colspan="2">template&lt;typename Output_  = double, typename Stat_ &gt; </td></tr>
<tr class="memitem:ace4fcc523c305a36b9d4b7f031367d13"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; Output_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#ace4fcc523c305a36b9d4b7f031367d13">average_vectors</a> (size_t n, std::vector&lt; Stat_ * &gt; in, bool skip_nan)</td></tr>
<tr class="separator:ace4fcc523c305a36b9d4b7f031367d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18cca7404ce3514a7d1f55a747c489be" id="r_a18cca7404ce3514a7d1f55a747c489be"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> &gt; </td></tr>
<tr class="memitem:a18cca7404ce3514a7d1f55a747c489be"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a18cca7404ce3514a7d1f55a747c489be">average_vectors_weighted</a> (<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">n</a>, std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> * &gt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">in</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">w</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> *<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">out</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">bool</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">skip_nan</a>)</td></tr>
<tr class="separator:a18cca7404ce3514a7d1f55a747c489be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a656535fcbb03d38ba16c66f941a5d1dd" id="r_a656535fcbb03d38ba16c66f941a5d1dd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a>  = double, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt; </td></tr>
<tr class="memitem:a656535fcbb03d38ba16c66f941a5d1dd"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a656535fcbb03d38ba16c66f941a5d1dd">average_vectors_weighted</a> (<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">n</a>, std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> * &gt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">in</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">w</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">bool</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">skip_nan</a>)</td></tr>
<tr class="separator:a656535fcbb03d38ba16c66f941a5d1dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0748c931e9c1250186a7794dcd440238" id="r_a0748c931e9c1250186a7794dcd440238"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a0748c931e9c1250186a7794dcd440238">compute_variable_weight</a> (<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">double</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">s</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">params</a>)</td></tr>
<tr class="separator:a0748c931e9c1250186a7794dcd440238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a744e0293aa7028a351a0aad0c9c3662d" id="r_a744e0293aa7028a351a0aad0c9c3662d"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt; </td></tr>
<tr class="memitem:a744e0293aa7028a351a0aad0c9c3662d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a744e0293aa7028a351a0aad0c9c3662d">compute_weights</a> (<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">num_blocks</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> *<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">sizes</a>, <a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">WeightPolicy</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">policy</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">variable</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">weights</a>)</td></tr>
<tr class="separator:a744e0293aa7028a351a0aad0c9c3662d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a87f8dd41754b80ec0509f20ac2340f" id="r_a8a87f8dd41754b80ec0509f20ac2340f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a>  = double, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> &gt; </td></tr>
<tr class="memitem:a8a87f8dd41754b80ec0509f20ac2340f"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran__blocks.html#a8a87f8dd41754b80ec0509f20ac2340f">compute_weights</a> (<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> &gt; &amp;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">sizes</a>, <a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">WeightPolicy</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">policy</a>, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">variable</a>)</td></tr>
<tr class="separator:a8a87f8dd41754b80ec0509f20ac2340f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Blocking utilities for <b>libscran</b>. </p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ac2412948da94055ff438267ba089ba97" name="ac2412948da94055ff438267ba089ba97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2412948da94055ff438267ba089ba97">&#9670;&#160;</a></span>WeightPolicy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">enum</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">class</a> <a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">scran_blocks::WeightPolicy</a> : <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">char</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Policy to use for weighting blocks based on their size, i.e., the number of cells in each block. This controls the calculation of weighted averages across blocks.</p>
<ul>
<li><code>NONE</code>: no weighting is performed. Larger blocks will contribute more to the weighted average.</li>
<li><code>EQUAL</code>: each block receives equal weight, regardless of its size. Equivalent to averaging across blocks without weights.</li>
<li><code>VARIABLE</code>: each batch is weighted using the logic in <code><a class="el" href="namespacescran__blocks.html#a0748c931e9c1250186a7794dcd440238">compute_variable_weight()</a></code>. This penalizes small blocks with unreliable statistics while equally weighting all large blocks. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ace4fcc523c305a36b9d4b7f031367d13" name="ace4fcc523c305a36b9d4b7f031367d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4fcc523c305a36b9d4b7f031367d13">&#9670;&#160;</a></span>average_vectors() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Output_  = double, typename Stat_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Output_ &gt; scran_blocks::average_vectors </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Stat_ * &gt;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_nan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">compute()</a></code> that allocates an output vector of averaged values.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Output</td><td>Floating-point output type. </td></tr>
    <tr><td class="paramname">Stat</td><td>Type of the input statistic, typically floating point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Length of each array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Vector of pointers to input arrays of length <code>n</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">skip_nan</td><td>Whether to check for NaNs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of length <code>n</code> is returned, containing the average of all arrays in <code>in</code>. </dd></dl>

</div>
</div>
<a id="a6fcb43b96a8b97c00cfaf3ae83df028d" name="a6fcb43b96a8b97c00cfaf3ae83df028d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fcb43b96a8b97c00cfaf3ae83df028d">&#9670;&#160;</a></span>average_vectors() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Stat_ , typename Output_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scran_blocks::average_vectors </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Stat_ * &gt;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Output_ *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_nan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average parallel elements across multiple arrays.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Stat_</td><td>Type of the input statistic, typically floating point. </td></tr>
    <tr><td class="paramname">Output_</td><td>Floating-point output type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Length of each array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Vector of pointers to input arrays of length <code>n</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Pointer to an output array of length <code>n</code>. On completion, <code>out</code> is filled with the average of all arrays in <code>in</code>. Specifically, each element of <code>out</code> is set to the average of the corresponding elements across all <code>in</code> arrays. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">skip_nan</td><td>Whether to check for NaNs. If <code>true</code>, NaNs are ignored in the average calculations for each element, at the cost of some efficiency. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a656535fcbb03d38ba16c66f941a5d1dd" name="a656535fcbb03d38ba16c66f941a5d1dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a656535fcbb03d38ba16c66f941a5d1dd">&#9670;&#160;</a></span>average_vectors_weighted() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a>  = double, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> &gt; scran_blocks::average_vectors_weighted </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a>&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> * &gt;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">bool</a>&#160;</td>
          <td class="paramname"><em>skip_nan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">compute_weighted()</a></code> that allocates an output vector of averaged values.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Output_</td><td>Floating-point output type. </td></tr>
    <tr><td class="paramname">Weight_</td><td>Type of the weight, typically floating point. </td></tr>
    <tr><td class="paramname">Stat_</td><td>Type of the input statistic, typically floating point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Length of each array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Vector of pointers to input arrays of the same length. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Pointer to an array of length equal to <code>in.size()</code>, containing the weight to use for each input array. Weights should be non-negative and finite. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">skip_nan</td><td>Whether to check for NaNs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector is returned containing with the average of all arrays in <code>in</code>. </dd></dl>

</div>
</div>
<a id="a18cca7404ce3514a7d1f55a747c489be" name="a18cca7404ce3514a7d1f55a747c489be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18cca7404ce3514a7d1f55a747c489be">&#9670;&#160;</a></span>average_vectors_weighted() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">void</a> scran_blocks::average_vectors_weighted </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a>&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Stat_</a> * &gt;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Output_</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">bool</a>&#160;</td>
          <td class="paramname"><em>skip_nan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute a weighted average of parallel elements across multiple arrays.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Stat_</td><td>Type of the input statistic, typically floating point. </td></tr>
    <tr><td class="paramname">Weight_</td><td>Type of the weight, typically floating point. </td></tr>
    <tr><td class="paramname">Output_</td><td>Floating-point output type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Length of each array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Vector of pointers to input arrays of length <code>n</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Pointer to an array of length equal to <code>in.size()</code>, containing the weight to use for each input array. Weights should be non-negative and finite. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Pointer to an output array of length <code>n</code>. On output, <code>out</code> is filled with the weighted average of all arrays in <code>in</code>. Specifically, each element of <code>out</code> is set to the weighted average of the corresponding elements across all <code>in</code> arrays. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">skip_nan</td><td>Whether to check for NaNs. If <code>true</code>, NaNs are ignored in the average calculations for each element, at the cost of some efficiency. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0748c931e9c1250186a7794dcd440238" name="a0748c931e9c1250186a7794dcd440238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0748c931e9c1250186a7794dcd440238">&#9670;&#160;</a></span>compute_variable_weight()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">double</a> scran_blocks::compute_variable_weight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">double</a>&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assign a variable weight to each block of cells, for use in computing a weighted average across blocks. The weight for each block is calculated from the size of that block.</p>
<ul>
<li>If the block size is less than <code><a class="el" href="structscran__blocks_1_1VariableWeightParameters.html#a0c21095e5569208fa946c7f1b5791ea5">VariableWeightParameters::lower_bound</a></code>, it has zero weight.</li>
<li>If the block size is greater than <code><a class="el" href="structscran__blocks_1_1VariableWeightParameters.html#a865b484b6fc8611048fcadab863de6bf">VariableWeightParameters::upper_bound</a></code>, it has weight of 1.</li>
<li>Otherwise, the block has weight proportional to its size, increasing linearly from 0 to 1 between the two bounds.</li>
</ul>
<p>Blocks that are "large enough" are considered to be equally trustworthy and receive the same weight, ensuring that each block contributes equally to the weighted average. By comparison, very small blocks receive lower weight as their statistics are generally less stable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Size of the block, in terms of the number of cells in that block. </td></tr>
    <tr><td class="paramname">params</td><td>Parameters for the weight calculation, consisting of the lower and upper bounds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Weight of the block, to use for computing a weighted average across blocks. </dd></dl>

</div>
</div>
<a id="a8a87f8dd41754b80ec0509f20ac2340f" name="a8a87f8dd41754b80ec0509f20ac2340f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a87f8dd41754b80ec0509f20ac2340f">&#9670;&#160;</a></span>compute_weights() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a>  = double, <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt; scran_blocks::compute_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> std::vector&lt; <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">WeightPolicy</a>&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A convenience overload that accepts and returns vectors.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Size_</td><td>Numeric type for the block size. </td></tr>
    <tr><td class="paramname">Weight_</td><td>Floating-point type for the output weights.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sizes</td><td>Vector containing the size of each block. </td></tr>
    <tr><td class="paramname">policy</td><td>Policy for weighting blocks of different sizes. </td></tr>
    <tr><td class="paramname">variable</td><td>Parameters for the variable block weights.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of block weights. </dd></dl>

</div>
</div>
<a id="a744e0293aa7028a351a0aad0c9c3662d" name="a744e0293aa7028a351a0aad0c9c3662d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a744e0293aa7028a351a0aad0c9c3662d">&#9670;&#160;</a></span>compute_weights() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> , <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">typename</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">void</a> scran_blocks::compute_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">size_t</a>&#160;</td>
          <td class="paramname"><em>num_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Size_</a> *&#160;</td>
          <td class="paramname"><em>sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#ac2412948da94055ff438267ba089ba97">WeightPolicy</a>&#160;</td>
          <td class="paramname"><em>policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">const</a> <a class="el" href="structscran__blocks_1_1VariableWeightParameters.html">VariableWeightParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>variable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacescran__blocks.html#a6fcb43b96a8b97c00cfaf3ae83df028d">Weight_</a> *&#160;</td>
          <td class="paramname"><em>weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute block weights for multiple blocks based on their size and the weighting policy. For variable weights, this function will call <code><a class="el" href="namespacescran__blocks.html#a0748c931e9c1250186a7794dcd440238">compute_variable_weight()</a></code> for each block.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Size_</td><td>Numeric type for the block size. </td></tr>
    <tr><td class="paramname">Weight_</td><td>Floating-point type for the output weights.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num_blocks</td><td>Number of blocks. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sizes</td><td>Pointer to an array of length <code>num_blocks</code>, containing the size of each block. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">policy</td><td>Policy for weighting blocks of different sizes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">variable</td><td>Parameters for the variable block weights. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">weights</td><td>Pointer to an array of length <code>num_blocks</code>. On output, this is filled with the weight of each block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
